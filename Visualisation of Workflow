from graphviz import Digraph
from IPython.display import Image

# Create decision tree graph
dot = Digraph("SmartScientificAssistant_DecisionTree", format="png")
dot.attr(rankdir="TB", size="8")

# Nodes
dot.node("Q", "Query Analyst\n(Classify user query)", shape="diamond", style="filled", color="lightblue")

dot.node("R", "Research Retriever\n(Search papers / datasets)", shape="box", style="rounded,filled", color="lightgreen")
dot.node("S", "Knowledge Synthesizer\n(Reason & summarize)", shape="box", style="rounded,filled", color="lightyellow")
dot.node("F", "Output Formatter\n(Generate final answer)", shape="box", style="rounded,filled", color="lightpink")
dot.node("E", "END", shape="doublecircle", color="black")

# Decision branches
dot.edge("Q", "R", label="Literature Review / Data Extraction")
dot.edge("Q", "S", label="Concept Explanation / Comparison")
dot.edge("R", "S", label="Summarize findings")
dot.edge("R", "F", label="Direct listing (datasets, stats)")
dot.edge("S", "F", label="Structured synthesis")
dot.edge("F", "E", label="Final output")

# Save file
output_path = "/mnt/data/smart_scientific_assistant_decision_tree"
dot.render(output_path, format="png", cleanup=False)

# Display the generated image
Image(filename=output_path + ".png")
